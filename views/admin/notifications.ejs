<% layout('layouts/boilerplate') %>

<div class="container my-5">
  <h2 class="mb-4">Admin Notifications</h2>

  <% if (notifications.length === 0) { %>
    <p class="text-muted">No notifications yet.</p>
  <% } else { %>
    <div class="d-flex justify-content-between mb-3">
      <form action="/notifications/read-all" method="POST">
        <button class="btn btn-sm btn-primary">Mark All as Read</button>
      </form>
      <form action="/notifications/delete-all" method="POST">
        <button class="btn btn-sm btn-danger">Delete All</button>
      </form>
    </div>

    <div class="list-group">
  <% notifications.forEach(notif => { %>
    <div class="list-group-item d-flex justify-content-between align-items-center">
      
      <!-- Clickable message that redirects -->
      <a href="/notifications/<%= notif._id.toString() %>/redirect" 
         class="flex-grow-1 text-decoration-none text-dark">
        <%= notif.message %>
        <br>
        <small class="text-muted"><%= notif.createdAt.toLocaleString() %></small>
      </a>

      <!-- Action buttons -->
      <div class="d-flex gap-2">
        <% if (!notif.read) { %>
          <form action="/notifications/<%= notif._id %>/read" method="POST" style="display:inline;">
            <button class="btn btn-sm btn-outline-success">Mark Read</button>
          </form>
        <% } %>
        <form action="/notifications/<%= notif._id %>/delete" method="POST" style="display:inline;">
          <button class="btn btn-sm btn-outline-danger">Delete</button>
        </form>
      </div>
    </div>
  <% }) %>
</div>
  <% } %>
</div>